{% extends "_base.html" %}
{% load i18n %}

{% block title %}
    {# Translators: Page title. #}
    {# Translators: تایتڵی پەڕە. #}
    {{ writer.name }}
{% endblock title %}


{% block content %}
    <!-- breadcrumb -->
    <ul class="breadcrumb">
        {# Translators: Breadcrumb link. #}
        {# Translators: لینکی برید کرەمب. #}
        <li class="breadcrumb-item"><a href="{% url 'home' %}">{% trans 'Home' %}</a></li>
        {# Translators: Breadcrumb link. #}
        {# Translators: لینکی برید کرەمب. #}
        <li class="breadcrumb-item"><a href="{% url 'library' %}">{% trans 'Library' %}</a></li>
        {# Translators: Breadcrumb link. #}
        {# Translators: لینکی برید کرەمب. #}
        <li class="breadcrumb-item"><a href="{% url 'writer-list' %}">{% trans 'Writers' %}</a></li>
        {# Translators: Breadcrumb link. #}
        {# Translators: لینکی برید کرەمب. #}
        <li class="breadcrumb-item active">{{ writer.name }}</li>
    </ul>

    <!-- Nav tabs -->
    <ul class="nav nav-tabs nav-justified" role="tablist">
        <li class="nav-item">
            <a class="nav-link active" data-toggle="tab" href="#detail">{% trans 'Detail' %}</a>
        </li>
        <li id="history_tab" class="nav-item">
            <a  class="nav-link" data-toggle="tab" href="#history">{% trans "History" %}</a>
        </li>
    </ul>

    <!-- Tab panes -->
    <div class="tab-content">
        <div id="detail" class="tab-pane active">
            <article class="media content-section">
                {% load thumbnail %}
                {% thumbnail writer.logo "125x125" crop="center" as im %}
                    <!-- link to Open the Modal -->
                    <a role="button" data-toggle="modal" data-target="#writer{{ writer.id }}">
                        <img class="rounded-circle article-img" src="{{im.url}}">
                    </a>
                {% endthumbnail %}
                <div class="media-body">
                    <div class="article-metadata">
                        {% trans "Created by" %}: 
                        <a class="mr-2" href="#">{{ writer.creator.first_name }} {{writer.creator.last_name}}</a>
                        {# Translators: For determine date. #}
                        {# Translators: بۆ دیاریکردنی بەروار (لە). #}
                        <small class="text-muted">{% trans 'in' %} {{ writer.timestamp|date:"d/m/Y - H:i:s" }}</small>
                        <a class="btn btn-outline-secondary btn-sm mt-1 mb-1" href="{% url 'writer-update' writer.id %}">{% trans "Update" %}</a>
                        <a class="btn btn-outline-danger btn-sm mt-1 mb-1 float-right" href="#">{% trans "Report" %}</a>
                    </div>
                    <h2 class="article-title">{{ writer.name }}</h2>
                    <small class="text-muted">{% trans "Born" %}: {{ writer.born_date|date:"d/m/Y" }}</small>
                    <br>
                    <small class="text-muted">{% trans "Died" %}: {{ writer.died_date|date:"d/m/Y" }}</small>
                    <p class="article-content">{% trans "Profile" %}:
                        <small class="text-muted">{{ writer.profile }}</small>
                    </p>
                </div>
            </article>
        </div>

        <div id="history" class="tab-pane fade"><br>
            <div class="spinner-grow text-muted"></div>
            <div class="spinner-grow text-primary"></div>
            <div class="spinner-grow text-success"></div>
            <div class="spinner-grow text-info"></div>
            <div class="spinner-grow text-warning"></div>
            <div class="spinner-grow text-danger"></div>
            <div class="spinner-grow text-secondary"></div>
            <div class="spinner-grow text-dark"></div>
            <div class="spinner-grow text-light"></div>
        </div>
    </div>

    <!-- The Modal -->
    <div class="modal fade" id="writer{{ writer.id }}">
        <div class="modal-dialog modal-l">
            <div class="modal-content">

                <!-- Modal Header -->
                <div class="modal-header">
                    <h4 class="modal-title">{{ writer.name }}</h4>
                    <button type="button" class="close" data-dismiss="modal">&times;</button>
                </div>

                <!-- Modal body -->
                <div class="modal-body">
                    <img src="{{ writer.image.url }}" class="rounded img-fluid">
                </div>

                <!-- Modal footer -->
                <div class="modal-footer">
                    <button type="button" class="btn btn-danger" data-dismiss="modal">{% trans "Close" %}</button>
                </div>
            </div>
        </div>
    </div>

{% endblock content%}


{% block javascript %}
    <script>
        $(document).ready(function(){
            $("#history_tab").click(function(){
                $.ajax({
                    url: "{% url 'writer-histories' writer.pk %}",
                    dataType: 'json',
                    success: function(returned_data){
                        $('#history').html(returned_data.histories_html)
                    }
                });

            });
        });
    </script>
{% endblock javascript %}